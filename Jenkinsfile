pipeline {
    agent any
    environment {
        PATH = "$PATH:/etc/maven/apache-maven-3.8.4/bin"
    }
    stages {
        stage("list env vars") {
            steps {
                sh "printenv | sort"
            }
        }
        stage('Build') {
            steps {
                script {
                    sh 'mvn clean package'
                }
            }
        }
        stage("SpnarQube analysis") {
            steps {
                withSonarQubeEnv("sonarqube-8.9.2") {
                    sh "mvn sonar:sonar"
                }        
            }
        }                
    }
    post {
        success {
            script{
                mail attachLog : true, bcc: '', body: " Hi Sender, "

This is an autogenerated email.

{ Build URL = ${env.BUILD_URL}
  Build Number =  ${env.BUILD_NUMBER}
  Job Name = ${env.JOB_NAME} }

" Thanks, "
" DevOps Team " ", cc: '', from: 'snehalgawde1997@gmail.com', replyTo: '', subject: "{Build Status = ${env.BUILD_STATUS} ${env.JOB_NAME} ${env.BUILD_NUMBER}}", to: 'snehalgawde1997@gmail.com'"
            }
        }
        failure {
            script {
                mail attachLog : true, bcc: '', body: " Hi Sender, "

This is an autogenerated email.

{ Build URL =  ${env.BUILD_URL}
  Build Number = ${env.BUILD_NUMBER}
  Job Name = ${env.JOB_NAME} }

" Thanks, "
" DevOps Team " ", cc: '', from: 'snehalgawde1997@gmail.com', replyTo: '', subject: "{Build Status = ${env.BUILD_STATUS} ${env.JOB_NAME} ${env.BUILD_NUMBER}}", to: 'snehalgawde1997@gmail.com'"
            }
        }
        
    }
}
